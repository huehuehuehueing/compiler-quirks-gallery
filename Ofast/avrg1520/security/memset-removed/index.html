
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>memset-removed - Compiler Optimization Gallery</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../custom.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#memset-removed" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Compiler Optimization Gallery" class="md-header__button md-logo" aria-label="Compiler Optimization Gallery" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Compiler Optimization Gallery
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              memset-removed
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Compiler Optimization Gallery" class="md-nav__button md-logo" aria-label="Compiler Optimization Gallery" data-md-component="logo">
      
  <img src="../../../../assets/logo.png" alt="logo">

    </a>
    Compiler Optimization Gallery
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../compilers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compilers
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../O0/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    O0 - No Optimization
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    O0 - No Optimization
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/armv7-clang2110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    armv7-clang2110
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/armv8-clang2110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    armv8-clang2110
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/avrg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    avrg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/cg152/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cg152
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/clang1910/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    clang1910
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/cmingw64_ucrt_gcc_1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cmingw64_ucrt_gcc_1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/csparc64g1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csparc64g1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/csparcg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csparcg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/mipsg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mipsg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/vc_v19_44_VS17_14_x64/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vc_v19_44_VS17_14_x64
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O0/vc_v19_44_VS17_14_x86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vc_v19_44_VS17_14_x86
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../O2/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    O2 - Standard Optimization
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    O2 - Standard Optimization
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/armv7-clang2110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    armv7-clang2110
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/armv8-clang2110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    armv8-clang2110
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/avrg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    avrg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/cg152/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cg152
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/clang1910/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    clang1910
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/cmingw64_ucrt_gcc_1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cmingw64_ucrt_gcc_1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/csparc64g1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csparc64g1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/csparcg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csparcg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/mipsg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mipsg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/vc_v19_44_VS17_14_x64/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vc_v19_44_VS17_14_x64
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O2/vc_v19_44_VS17_14_x86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vc_v19_44_VS17_14_x86
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../O3/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    O3 - Aggressive Optimization
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    O3 - Aggressive Optimization
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/armv7-clang2110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    armv7-clang2110
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/armv8-clang2110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    armv8-clang2110
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/avrg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    avrg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/cg152/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cg152
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/clang1910/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    clang1910
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/cmingw64_ucrt_gcc_1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cmingw64_ucrt_gcc_1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/csparc64g1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csparc64g1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/csparcg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csparcg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/mipsg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mipsg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/vc_v19_44_VS17_14_x64/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vc_v19_44_VS17_14_x64
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../O3/vc_v19_44_VS17_14_x86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vc_v19_44_VS17_14_x86
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Ofast - Fast Math Optimization
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ofast - Fast Math Optimization
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../armv7-clang2110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    armv7-clang2110
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../armv8-clang2110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    armv8-clang2110
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    avrg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cg152/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cg152
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../clang1910/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    clang1910
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmingw64_ucrt_gcc_1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cmingw64_ucrt_gcc_1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../csparc64g1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csparc64g1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../csparcg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csparcg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../mipsg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mipsg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../vc_v19_44_VS17_14_x64/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vc_v19_44_VS17_14_x64
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../vc_v19_44_VS17_14_x86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vc_v19_44_VS17_14_x86
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../Os/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Os - Size Optimization
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Os - Size Optimization
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/armv7-clang2110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    armv7-clang2110
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/armv8-clang2110/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    armv8-clang2110
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/avrg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    avrg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/cg152/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cg152
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/clang1910/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    clang1910
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/cmingw64_ucrt_gcc_1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cmingw64_ucrt_gcc_1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/csparc64g1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csparc64g1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/csparcg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csparcg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/mipsg1520/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    mipsg1520
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/vc_v19_44_VS17_14_x64/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vc_v19_44_VS17_14_x64
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../Os/vc_v19_44_VS17_14_x86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vc_v19_44_VS17_14_x86
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#source-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Source Code
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assembly-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        Assembly Output
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#explanation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Explanation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Explanation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stack-frame-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stack Frame Setup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-critical-security-issue-missing-memset" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Critical Security Issue: Missing memset()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#password-verification-logic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Password Verification Logic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stack-cleanup-and-return" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stack Cleanup and Return
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-observations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Observations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="memset-removed">memset-removed<a class="headerlink" href="#memset-removed" title="Permanent link">&para;</a></h1>
<div class="admonition info">
<p class="admonition-title">Details</p>
<p><strong>Source:</strong> <code>security/memset-removed.c</code>
<strong>Compiler:</strong> avrg1520 (AVR)
<strong>Scenario:</strong> Ofast - Fast Math Optimization (<code>-Ofast</code>)</p>
</div>
<h2 id="source-code">Source Code<a class="headerlink" href="#source-code" title="Permanent link">&para;</a></h2>
<div class="highlight"><span class="filename">memset-removed.c</span><pre><span></span><code><span class="cm">/*</span>
<span class="cm"> * Security issue: memset() to clear sensitive data is removed</span>
<span class="cm"> * as dead code when the buffer is not used afterward.</span>
<span class="cm"> *</span>
<span class="cm"> * This is a real security vulnerability pattern - passwords</span>
<span class="cm"> * and keys may remain in memory after &quot;clearing&quot;.</span>
<span class="cm"> */</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">process_password</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">password</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">local_copy</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>

<span class="w">    </span><span class="cm">/* Copy password for processing */</span>
<span class="w">    </span><span class="n">strncpy</span><span class="p">(</span><span class="n">local_copy</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">local_copy</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">local_copy</span><span class="p">[</span><span class="k">sizeof</span><span class="p">(</span><span class="n">local_copy</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/* Do something observable with the password (simulate auth check) */</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">local_copy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;s&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">local_copy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">        </span><span class="n">local_copy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;c&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">local_copy</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">        </span><span class="n">local_copy</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">local_copy</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;t&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;Access granted&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;Access denied&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/* Security: clear the password from stack</span>
<span class="cm">     * BUG: This memset is often REMOVED by optimizer</span>
<span class="cm">     * because local_copy is not used afterward!</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">local_copy</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">local_copy</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">test_password</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">process_password</span><span class="p">(</span><span class="s">&quot;secret&quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="assembly-output">Assembly Output<a class="headerlink" href="#assembly-output" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">memset-removed.asm</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nf">__SP_H__</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0x3e</span>
<span class="nf">__SP_L__</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0x3d</span>
<span class="nf">__SREG__</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0x3f</span>
<span class="nf">__tmp_reg__</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span>
<span class="nf">__zero_reg__</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span>
<span class="nl">.LC0:</span>
<span class="w">        </span><span class="na">.string</span><span class="w"> </span><span class="s">&quot;Access granted&quot;</span>
<span class="nl">.LC1:</span>
<span class="w">        </span><span class="na">.string</span><span class="w"> </span><span class="s">&quot;Access denied&quot;</span>
<span class="nf">process_password</span><span class="p">(</span><span class="no">char</span><span class="w"> </span><span class="no">const</span><span class="p">*):</span>
<span class="w">        </span><span class="nf">push</span><span class="w"> </span><span class="no">r28</span>
<span class="w">        </span><span class="nf">push</span><span class="w"> </span><span class="no">r29</span>
<span class="w">        </span><span class="nf">in</span><span class="w"> </span><span class="no">r28</span><span class="p">,</span><span class="no">__SP_L__</span>
<span class="w">        </span><span class="nf">in</span><span class="w"> </span><span class="no">r29</span><span class="p">,</span><span class="no">__SP_H__</span>
<span class="w">        </span><span class="nf">subi</span><span class="w"> </span><span class="no">r28</span><span class="p">,</span><span class="mi">64</span>
<span class="w">        </span><span class="nf">sbc</span><span class="w"> </span><span class="no">r29</span><span class="p">,</span><span class="no">__zero_reg__</span>
<span class="w">        </span><span class="nf">in</span><span class="w"> </span><span class="no">__tmp_reg__</span><span class="p">,</span><span class="no">__SREG__</span>
<span class="w">        </span><span class="nf">cli</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SP_H__</span><span class="p">,</span><span class="no">r29</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SREG__</span><span class="p">,</span><span class="no">__tmp_reg__</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SP_L__</span><span class="p">,</span><span class="no">r28</span>
<span class="na">.L__stack_usage</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">66</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r20</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">63</span><span class="p">)</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r21</span><span class="p">,</span><span class="mi">0</span>
<span class="w">        </span><span class="nf">mov</span><span class="w"> </span><span class="no">r22</span><span class="p">,</span><span class="no">r24</span>
<span class="w">        </span><span class="nf">mov</span><span class="w"> </span><span class="no">r23</span><span class="p">,</span><span class="no">r25</span>
<span class="w">        </span><span class="nf">mov</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">r28</span>
<span class="w">        </span><span class="nf">mov</span><span class="w"> </span><span class="no">r25</span><span class="p">,</span><span class="no">r29</span>
<span class="w">        </span><span class="nf">adiw</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="mi">1</span>
<span class="w">        </span><span class="nf">rcall</span><span class="w"> </span><span class="no">strncpy</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">1</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">115</span><span class="p">)</span>
<span class="w">        </span><span class="nf">brne</span><span class="w"> </span><span class="no">.L2</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">2</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="w">        </span><span class="nf">breq</span><span class="w"> </span><span class="no">.L5</span>
<span class="nl">.L2:</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(.</span><span class="no">LC1</span><span class="p">)</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r25</span><span class="p">,</span><span class="no">hi8</span><span class="p">(.</span><span class="no">LC1</span><span class="p">)</span>
<span class="nl">.L3:</span>
<span class="w">        </span><span class="nf">subi</span><span class="w"> </span><span class="no">r28</span><span class="p">,-</span><span class="mi">64</span>
<span class="w">        </span><span class="nf">sbci</span><span class="w"> </span><span class="no">r29</span><span class="p">,-</span><span class="mi">1</span>
<span class="w">        </span><span class="nf">in</span><span class="w"> </span><span class="no">__tmp_reg__</span><span class="p">,</span><span class="no">__SREG__</span>
<span class="w">        </span><span class="nf">cli</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SP_H__</span><span class="p">,</span><span class="no">r29</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SREG__</span><span class="p">,</span><span class="no">__tmp_reg__</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SP_L__</span><span class="p">,</span><span class="no">r28</span>
<span class="w">        </span><span class="nf">pop</span><span class="w"> </span><span class="no">r29</span>
<span class="w">        </span><span class="nf">pop</span><span class="w"> </span><span class="no">r28</span>
<span class="w">        </span><span class="nf">rjmp</span><span class="w"> </span><span class="no">puts</span>
<span class="nl">.L5:</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">3</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="w">        </span><span class="nf">brne</span><span class="w"> </span><span class="no">.L2</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">4</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">114</span><span class="p">)</span>
<span class="w">        </span><span class="nf">brne</span><span class="w"> </span><span class="no">.L2</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">5</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="w">        </span><span class="nf">brne</span><span class="w"> </span><span class="no">.L2</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">6</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">116</span><span class="p">)</span>
<span class="w">        </span><span class="nf">brne</span><span class="w"> </span><span class="no">.L2</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(.</span><span class="no">LC0</span><span class="p">)</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r25</span><span class="p">,</span><span class="no">hi8</span><span class="p">(.</span><span class="no">LC0</span><span class="p">)</span>
<span class="w">        </span><span class="nf">rjmp</span><span class="w"> </span><span class="no">.L3</span>
<span class="nl">.LC2:</span>
<span class="w">        </span><span class="na">.string</span><span class="w"> </span><span class="s">&quot;secret&quot;</span>
<span class="nf">test_password</span><span class="p">():</span>
<span class="w">        </span><span class="nf">push</span><span class="w"> </span><span class="no">r28</span>
<span class="w">        </span><span class="nf">push</span><span class="w"> </span><span class="no">r29</span>
<span class="w">        </span><span class="nf">in</span><span class="w"> </span><span class="no">r28</span><span class="p">,</span><span class="no">__SP_L__</span>
<span class="w">        </span><span class="nf">in</span><span class="w"> </span><span class="no">r29</span><span class="p">,</span><span class="no">__SP_H__</span>
<span class="w">        </span><span class="nf">subi</span><span class="w"> </span><span class="no">r28</span><span class="p">,</span><span class="mi">64</span>
<span class="w">        </span><span class="nf">sbc</span><span class="w"> </span><span class="no">r29</span><span class="p">,</span><span class="no">__zero_reg__</span>
<span class="w">        </span><span class="nf">in</span><span class="w"> </span><span class="no">__tmp_reg__</span><span class="p">,</span><span class="no">__SREG__</span>
<span class="w">        </span><span class="nf">cli</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SP_H__</span><span class="p">,</span><span class="no">r29</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SREG__</span><span class="p">,</span><span class="no">__tmp_reg__</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SP_L__</span><span class="p">,</span><span class="no">r28</span>
<span class="na">.L__stack_usage</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">66</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r20</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">63</span><span class="p">)</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r21</span><span class="p">,</span><span class="mi">0</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r22</span><span class="p">,</span><span class="no">lo8</span><span class="p">(.</span><span class="no">LC2</span><span class="p">)</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r23</span><span class="p">,</span><span class="no">hi8</span><span class="p">(.</span><span class="no">LC2</span><span class="p">)</span>
<span class="w">        </span><span class="nf">mov</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">r28</span>
<span class="w">        </span><span class="nf">mov</span><span class="w"> </span><span class="no">r25</span><span class="p">,</span><span class="no">r29</span>
<span class="w">        </span><span class="nf">adiw</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="mi">1</span>
<span class="w">        </span><span class="nf">rcall</span><span class="w"> </span><span class="no">strncpy</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">1</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">115</span><span class="p">)</span>
<span class="w">        </span><span class="nf">brne</span><span class="w"> </span><span class="no">.L7</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">2</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="w">        </span><span class="nf">breq</span><span class="w"> </span><span class="no">.L9</span>
<span class="nl">.L7:</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(.</span><span class="no">LC1</span><span class="p">)</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r25</span><span class="p">,</span><span class="no">hi8</span><span class="p">(.</span><span class="no">LC1</span><span class="p">)</span>
<span class="nl">.L8:</span>
<span class="w">        </span><span class="nf">subi</span><span class="w"> </span><span class="no">r28</span><span class="p">,-</span><span class="mi">64</span>
<span class="w">        </span><span class="nf">sbci</span><span class="w"> </span><span class="no">r29</span><span class="p">,-</span><span class="mi">1</span>
<span class="w">        </span><span class="nf">in</span><span class="w"> </span><span class="no">__tmp_reg__</span><span class="p">,</span><span class="no">__SREG__</span>
<span class="w">        </span><span class="nf">cli</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SP_H__</span><span class="p">,</span><span class="no">r29</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SREG__</span><span class="p">,</span><span class="no">__tmp_reg__</span>
<span class="w">        </span><span class="nf">out</span><span class="w"> </span><span class="no">__SP_L__</span><span class="p">,</span><span class="no">r28</span>
<span class="w">        </span><span class="nf">pop</span><span class="w"> </span><span class="no">r29</span>
<span class="w">        </span><span class="nf">pop</span><span class="w"> </span><span class="no">r28</span>
<span class="w">        </span><span class="nf">rjmp</span><span class="w"> </span><span class="no">puts</span>
<span class="nl">.L9:</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">3</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="w">        </span><span class="nf">brne</span><span class="w"> </span><span class="no">.L7</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">4</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">114</span><span class="p">)</span>
<span class="w">        </span><span class="nf">brne</span><span class="w"> </span><span class="no">.L7</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">5</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="w">        </span><span class="nf">brne</span><span class="w"> </span><span class="no">.L7</span>
<span class="w">        </span><span class="nf">ldd</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">Y</span><span class="err">+</span><span class="mi">6</span>
<span class="w">        </span><span class="nf">cpi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(</span><span class="mi">116</span><span class="p">)</span>
<span class="w">        </span><span class="nf">brne</span><span class="w"> </span><span class="no">.L7</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r24</span><span class="p">,</span><span class="no">lo8</span><span class="p">(.</span><span class="no">LC0</span><span class="p">)</span>
<span class="w">        </span><span class="nf">ldi</span><span class="w"> </span><span class="no">r25</span><span class="p">,</span><span class="no">hi8</span><span class="p">(.</span><span class="no">LC0</span><span class="p">)</span>
<span class="w">        </span><span class="nf">rjmp</span><span class="w"> </span><span class="no">.L8</span>
</code></pre></div></td></tr></table></div>
<h2 id="explanation">Explanation<a class="headerlink" href="#explanation" title="Permanent link">&para;</a></h2>
<p>the key insight here is that <strong>the <code>memset()</code> call to clear the password has been completely removed by the optimizer</strong>, which is the security vulnerability the code is demonstrating.</p>
<h3 id="stack-frame-setup">Stack Frame Setup<a class="headerlink" href="#stack-frame-setup" title="Permanent link">&para;</a></h3>
<p>Both functions start by setting up a stack frame (a reserved area of memory for local variables):</p>
<div class="highlight"><pre><span></span><code>push r28
push r29
in r28,__SP_L__
in r29,__SP_H__
subi r28,64
sbc r29,__zero_reg__
</code></pre></div>
<p>This allocates 64 bytes on the stack for the <code>local_copy</code> buffer. The <code>Y</code> register pair (<code>r28:r29</code>) acts as a frame pointerthink of it as a bookmark that marks where the local variables are stored. The <code>push</code> and <code>in</code> instructions save the old frame pointer, then <code>subi</code> (subtract immediate) reduces the stack pointer by 64 to make room.</p>
<h3 id="the-critical-security-issue-missing-memset">The Critical Security Issue: Missing <code>memset()</code><a class="headerlink" href="#the-critical-security-issue-missing-memset" title="Permanent link">&para;</a></h3>
<p>The most important observation is what's <strong>not</strong> in the assembly: there is no call to <code>memset()</code> to clear the password buffer. Look at the function flow:</p>
<ol>
<li><code>strncpy</code> copies the password into <code>local_copy</code></li>
<li>The code checks each character of the password (comparing against ASCII values like <code>115</code> for 's', <code>101</code> for 'e', etc.)</li>
<li>The function calls <code>puts()</code> to print the result</li>
<li>The function returns</li>
</ol>
<p>The <code>memset(local_copy, 0, sizeof(local_copy))</code> line from the source code is completely gone. The <code>-Ofast</code> optimization flag tells the compiler to prioritize speed, and since <code>local_copy</code> is never read after the password check, the compiler's dead code elimination optimization removes the <code>memset()</code> call entirely. <strong>This leaves the password sitting in stack memory</strong>, which is a real security vulnerabilityan attacker could potentially read it from memory.</p>
<h3 id="password-verification-logic">Password Verification Logic<a class="headerlink" href="#password-verification-logic" title="Permanent link">&para;</a></h3>
<p>The password check uses a series of character comparisons:</p>
<div class="highlight"><pre><span></span><code>ldd r24,Y+1          ; Load byte at offset 1 (first char of password)
cpi r24,lo8(115)     ; Compare with &#39;s&#39; (ASCII 115)
brne .L2             ; Branch if not equal to &quot;Access denied&quot;
ldd r24,Y+2          ; Load byte at offset 2
cpi r24,lo8(101)     ; Compare with &#39;e&#39; (ASCII 101)
breq .L5             ; Branch if equal, continue checking
</code></pre></div>
<p>Each character is loaded from the stack buffer using <code>ldd</code> (load with displacement), compared using <code>cpi</code> (compare immediate), and branches skip to the "Access denied" path if any character doesn't match. If all six characters match "secret", the code loads the address of the "Access granted" string and jumps to <code>puts()</code>.</p>
<h3 id="stack-cleanup-and-return">Stack Cleanup and Return<a class="headerlink" href="#stack-cleanup-and-return" title="Permanent link">&para;</a></h3>
<p>At the end, the function restores the stack pointer:</p>
<div class="highlight"><pre><span></span><code>subi r28,-64         ; Add 64 back to stack pointer (note: -(-64) = +64)
sbci r29,-1          ; Add borrow if needed
pop r29
pop r28
rjmp puts            ; Tail call optimization: jump directly to puts
</code></pre></div>
<p>The <code>rjmp puts</code> is a tail call optimizationinstead of calling <code>puts()</code> and returning, the function jumps directly to <code>puts()</code>, which will return to the original caller. This saves one instruction.</p>
<h3 id="key-observations">Key Observations<a class="headerlink" href="#key-observations" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>The <code>memset()</code> is eliminated</strong>: This is the core security issue. The optimizer sees that <code>local_copy</code> is never used after the password check, so it removes the clearing operation as dead code.</li>
<li><strong>Both functions are nearly identical</strong>: <code>process_password()</code> and <code>test_password()</code> generate almost the same assembly because the compiler inlines the password string directly into <code>test_password()</code>.</li>
<li><strong>Character-by-character checking</strong>: The password verification uses individual byte loads and comparisons rather than a loop, which is fast but verbose.</li>
<li><strong>Tail call optimization</strong>: The final <code>rjmp puts</code> avoids an extra function call overhead by jumping directly.</li>
</ul>
<hr />
<p><a href="../../"> Back to avrg1520</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["content.code.copy", "navigation.sections", "navigation.indexes", "navigation.top", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>